<div class="container">
  <!-- Header -->
  <div class="header">
    <div class="logo">
      <i class="fas fa-seedling"></i>
      <span>Soil Monitor</span>
    </div>
    <button (click)="logout()" class="logout-btn">
      <i class="fas fa-sign-out-alt"></i>
      ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </button>
  </div>

  <!-- User Info Section -->
  <div class="user-info">
    <div class="user-details">
      <div class="user-item">
        <i class="fas fa-user"></i>
        <span class="label">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</span>
        <span class="value">{{ userName || userEmail || userID }}</span>
      </div>
      <div class="user-item">
        <i class="fas fa-clock"></i>
        <span class="label">‡πÄ‡∏ß‡∏•‡∏≤:</span>
        <span class="value">{{ currentTime }}</span>
      </div>
    </div>
  </div>

  <!-- Device Section -->
  <div class="device-section">
    <div class="device-header">
      <i class="fas fa-microchip"></i>
      <h3>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</h3>
    </div>

    <div class="device-selector">
      <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡∏Å‡∏£‡∏ì‡∏µ > 1 ‡∏ä‡∏¥‡πâ‡∏ô) -->
      <select class="device-select" *ngIf="devices.length > 1" [(ngModel)]="selectedDeviceId"
        (ngModelChange)="onDeviceChange()" aria-label="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå">
        <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå --</option>
        <option *ngFor="let device of devices" [value]="device.deviceid">
          {{ device.device_name || device.deviceid }}
        </option>
      </select>

      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå -->
      <div class="device-name" *ngIf="devices.length === 1">
        {{ devices[0].device_name || devices[0].deviceid }}
      </div>
      <div class="device-name" *ngIf="devices.length === 0">
        ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
      </div>

      <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Online/Offline -->
      <div class="status-indicator" [ngClass]="{
          online: selectedDevice?.status === 'online',
          offline: selectedDevice?.status !== 'online' || devices.length === 0
        }">
        <div class="status-dot"></div>
        <span class="status-text">
          {{ devices.length === 0 ? 'Offline' : (selectedDevice?.status === 'online' ? 'Online' : 'Offline') }}
        </span>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions-grid">
    <div class="action-card primary" (click)="goToMeasure()">
      <i class="fas fa-play-circle"></i>
      <h4>‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤</h4>
      <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÉ‡∏ô‡∏î‡∏¥‡∏ô</p>
    </div>

    <div class="action-card secondary" (click)="goToHistory()">
      <i class="fas fa-history"></i>
      <h4>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤</h4>
      <p>‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ</p>
    </div>

    <div class="action-card info" (click)="goToProfile()">
      <i class="fas fa-user-circle"></i>
      <h4>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h4>
      <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</p>
    </div>

    <div class="action-card success" (click)="goToContactAdmin()">
      <i class="fas fa-headset"></i>
      <h4>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Admin</h4>
      <p>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</p>
    </div>
  </div>

  <!-- Add Device Section -->
  <div class="add-device">
    <h3>
      <i class="fas fa-plus-circle"></i>
      ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡∏°‡πà
    </h3>

    <div class="device-help">
      <p><strong>üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong></p>
      <ul>
        <li>‡∏û‡∏¥‡∏°‡∏û‡πå <strong>"test"</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö ESP32-soil-test</li>
        <li>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÄ‡∏ä‡πà‡∏ô "esp32-soil-01"</li>
        <li>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏∞‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô online ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
      </ul>
    </div>

    <div class="device-input-group">
      <input class="claim-input" type="text" [(ngModel)]="claimDeviceId" (keyup.enter)="addNewDevice()"
        placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡πÄ‡∏ä‡πà‡∏ô test device ‡∏´‡∏£‡∏∑‡∏≠ esp32-soil-01" aria-label="Device ID">

      <button class="claim-btn" [disabled]="requestingClaim || !claimDeviceId.trim()" (click)="addNewDevice()"
        aria-label="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå">
        <i class="fas fa-plus" *ngIf="!requestingClaim"></i>
        <span class="spinner" *ngIf="requestingClaim" aria-hidden="true"></span>
        <span *ngIf="!requestingClaim">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</span>
      </button>
    </div>

    <div class="claim-help">
      ‡∏û‡∏¥‡∏°‡∏û‡πå Device ID ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    </div>

    <div class="claim-status" *ngIf="lastClaimMessage" [ngClass]="lastClaimType">
      <div class="status-dot"></div>
      {{ lastClaimMessage }}
    </div>
  </div>

  <!-- Notification Popup -->
  <div class="notification-overlay" *ngIf="showNotification" (click)="closeNotification()">
    <div class="notification-popup" (click)="$event.stopPropagation()">
      <div class="notification-header" [ngClass]="notificationType">
        <i class="notification-icon" [ngClass]="getNotificationIcon()"></i>
        <h3 class="notification-title">{{ notificationTitle }}</h3>
        <button class="close-btn" (click)="closeNotification()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="notification-body">
        <p class="notification-message">{{ notificationMessage }}</p>
        <div class="notification-actions" *ngIf="showNotificationActions">
          <button class="btn-secondary" (click)="closeNotification()">‡∏õ‡∏¥‡∏î</button>
          <button class="btn-primary" (click)="onNotificationConfirm()" *ngIf="notificationConfirmText">
            {{ notificationConfirmText }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>