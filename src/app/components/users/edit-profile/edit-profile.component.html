<div class="profile-container" (click)="closeCardMenu()">
  <!-- Back arrow ย้ายออกจาก card -->
  <i class="fas fa-arrow-left back" (click)="goBack()"></i>

  <!-- จุด 3 จุดย้ายออกจาก card -->
  <div class="card-menu" (click)="toggleCardMenu(); $event.stopPropagation()">
    <i class="fas fa-ellipsis-v"></i>
    <div class="menu-dropdown" *ngIf="showCardMenu" (click)="$event.stopPropagation()">
      <div class="menu-item" (click)="goToHistory(); closeCardMenu()">
        <i class="fas fa-history"></i>
        ดูประวัติการวัด
      </div>
      <div class="menu-item" (click)="goToContactAdmin(); closeCardMenu()">
        <i class="fas fa-user-shield"></i>
        ติดต่อ Admin
      </div>
    </div>
  </div>

  <div class="profile-card" (click)="$event.stopPropagation()">
    <h2 class="title">แก้ไขข้อมูลผู้ใช้</h2>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>กำลังโหลดข้อมูล...</p>
    </div>

    <!-- Profile Form -->
    <div class="profile-form" *ngIf="!isLoading">
      <div class="info-row">
        <div class="label">Username</div>
        <input type="text" class="value" [(ngModel)]="username" placeholder="ชื่อผู้ใช้" />
      </div>

      <div class="info-row">
        <div class="label">Email</div>
        <input type="email" class="value" [(ngModel)]="email" readonly placeholder="อีเมล" />
      </div>

      <div class="info-row">
        <div class="label">Phone</div>
        <input type="tel" class="value" [class.error]="phoneNumberError" [(ngModel)]="phoneNumber"
          placeholder="เบอร์โทรศัพท์ (10 หลัก)" maxlength="10" pattern="[0-9]*" (input)="onPhoneNumberInput($event)"
          (keypress)="onPhoneNumberKeyPress($event)" (blur)="validatePhoneNumber()" />
        <div class="error-message" *ngIf="phoneNumberError">
          {{ phoneNumberErrorMessage }}
        </div>
      </div>
      <div class="button-group">
        <button class="edit-button" (click)="saveProfile()">บันทึก</button>
      </div>
    </div>
  </div>
</div>