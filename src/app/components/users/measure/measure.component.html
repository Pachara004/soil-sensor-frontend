<div class="measure-container" (click)="closeCardMenu()">
  <div class="card" (click)="$event.stopPropagation()">
    <i class="fas fa-arrow-left back" (click)="goBack()"></i>

    <!-- ‡∏à‡∏∏‡∏î‡∏™‡∏≤‡∏°‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô -->
    <div class="card-menu" (click)="toggleCardMenu(); $event.stopPropagation()">
      <i class="fas fa-ellipsis-v"></i>
      <div class="menu-dropdown" *ngIf="showCardMenu" (click)="$event.stopPropagation()">
        <div class="menu-item" (click)="goToHistory(); closeCardMenu()">
          <i class="fas fa-history"></i>
          ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î
        </div>
        <div class="menu-item" (click)="goToContactAdmin(); closeCardMenu()">
          <i class="fas fa-user-shield"></i>
          ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Admin
        </div>
      </div>
    </div>

    <div class="header">
      <div class="user-summary">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-details">
          <h3 class="user-name">{{ userName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</h3>
          <p class="user-email">{{ userEmail || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</p>
        </div>
      </div>
    </div>

    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô -->
    <div class="control-buttons">
      <button class="control-btn" (click)="toggleDeviceInfo()" [ngClass]="{ active: showDeviceInfo }">
        {{ showDeviceInfo ? '‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå' : '‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå' }}
      </button>
      <button class="control-btn" (click)="toggleMainMap()" [ngClass]="{ active: showMainMap }">
        {{ showMainMap ? '‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà' : '‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà' }}
      </button>
      <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö test devices -->
      <button class="control-btn test-btn" *ngIf="deviceName && deviceName.toLowerCase().includes('test')"
        (click)="generateFakeSensorData()">
        <i class="fas fa-flask"></i>
        ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏•‡∏≠‡∏°‡πÉ‡∏´‡∏°‡πà
      </button>
    </div>

    <!-- ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Device ‡∏à‡∏≤‡∏Å Firebase -->
    <div class="device-info" *ngIf="showDeviceInfo">
      <div class="info-row">
        <span class="label">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</span>
        <span class="value">{{ liveData?.deviceName || deviceName || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</span>
      </div>
      <div class="info-row">
        <span class="label">Device ID:</span>
        <span class="value">{{ liveData?.deviceId || deviceId || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏' }}</span>
      </div>
      <div class="info-row" *ngIf="liveData?.sensorOnline !== undefined">
        <span class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå:</span>
        <span class="value" [ngClass]="liveData.sensorOnline ? 'status-online' : 'status-offline'">
          <i class="fas" [ngClass]="liveData.sensorOnline ? 'fa-check-circle' : 'fa-times-circle'"></i>
          {{ liveData.sensorOnline ? '‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå' : '‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå' }}
        </span>
      </div>
      <div class="info-row" *ngIf="liveData?.soilContact !== undefined">
        <span class="label">‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏î‡∏¥‡∏ô:</span>
        <span class="value" [ngClass]="liveData.soilContact ? 'status-online' : 'status-offline'">
          <i class="fas" [ngClass]="liveData.soilContact ? 'fa-check-circle' : 'fa-times-circle'"></i>
          {{ liveData.soilContact ? '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠' : '‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠' }}
        </span>
      </div>
      <div class="info-row" *ngIf="liveData?.status">
        <span class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
        <span class="value status-{{ liveData.status }}">{{ liveData.status }}</span>
      </div>
      <div class="info-row" *ngIf="liveData?.uptime">
        <span class="label">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</span>
        <span class="value">{{ liveData.uptime }} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</span>
      </div>
      <div class="info-row" *ngIf="liveData?.timestamp">
        <span class="label">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</span>
        <span class="value">{{ formatTimestamp(liveData.timestamp) }}</span>
      </div>
    </div>

    <!-- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î -->
    <div class="point-selection-section" *ngIf="measurementPoints.length > 0">
      <div class="section-title">
        <i class="fas fa-map-marker-alt"></i>
        ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î
      </div>
      
      <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
      <div class="selected-point-info" *ngIf="selectedPointIndex !== null">
        <div class="point-card selected">
          <div class="point-header">
            <i class="fas fa-crosshairs"></i>
            <span>‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: {{ selectedPointIndex + 1 }}</span>
          </div>
          <div class="point-coordinates">
            <span>‡∏û‡∏¥‡∏Å‡∏±‡∏î: {{ measurementPoints[selectedPointIndex][1].toFixed(6) }}, {{ measurementPoints[selectedPointIndex][0].toFixed(6) }}</span>
          </div>
          <div class="point-status" *ngIf="measuredPoints.includes(selectedPointIndex)">
            <i class="fas fa-check-circle"></i>
            <span>‡∏ß‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß</span>
          </div>
        </div>
      </div>
      
      <!-- ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î -->
      <div class="measurement-stats">
        <div class="stat-item">
          <span class="stat-label">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
          <span class="stat-value">{{ measurementPoints.length }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">‡∏ß‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß:</span>
          <span class="stat-value completed">{{ measuredPoints.length }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span>
          <span class="stat-value remaining">{{ measurementPoints.length - measuredPoints.length }}</span>
        </div>
      </div>
      
      <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ß‡∏±‡∏î‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
      <button class="measure-selected-btn" 
              [ngClass]="{'waiting': isWaitingForStable, 'disabled': selectedPointIndex === null || measuredPoints.includes(selectedPointIndex!)}"
              (click)="measureSelectedPoint()" 
              [disabled]="isLoading || isWaitingForStable || selectedPointIndex === null || measuredPoints.includes(selectedPointIndex!)">
        <span *ngIf="!isLoading && !isWaitingForStable">
          <i class="fas fa-play"></i>
          ‡∏ß‡∏±‡∏î‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        </span>
        <span *ngIf="isLoading && !isWaitingForStable">
          <i class="fas fa-spinner fa-spin"></i>
          ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏î...
        </span>
        <span *ngIf="isWaitingForStable">
          <i class="fas fa-clock"></i>
          ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà... {{ countdownSeconds }} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        </span>
      </button>
      
      <!-- ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ -->
      <div class="instructions">
        <div class="instruction-item">
          <i class="fas fa-mouse-pointer"></i>
          <span>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
        </div>
        <div class="instruction-item">
          <i class="fas fa-play"></i>
          <span>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ß‡∏±‡∏î‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏î‡∏Ñ‡πà‡∏≤</span>
        </div>
        <div class="instruction-item">
          <i class="fas fa-check-circle"></i>
          <span>‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</span>
        </div>
      </div>
    </div>

    <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏ß‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏î‡∏¥‡∏°) -->
    <button class="save-btn" 
            [ngClass]="{'waiting': isWaitingForStable}"
            (click)="saveMeasurement()" 
            [disabled]="isLoading || isWaitingForStable">
      <span *ngIf="!isLoading && !isWaitingForStable">‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤</span>
      <span *ngIf="isLoading && !isWaitingForStable">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...</span>
      <span *ngIf="isWaitingForStable">
        <i class="fas fa-clock"></i>
        ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà... {{ countdownSeconds }} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
      </span>
    </button>

    <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 6 ‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏° ESP32 -->
    <div class="sensor-grid">
      <!-- Temperature -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <i class="fas fa-thermometer-half temperature-icon"></i>
        </div>
        <div class="sensor-value">{{ temperature || 0 }}</div>
        <div class="sensor-unit">¬∞C</div>
        <div class="sensor-label">TEMPERATURE</div>
      </div>

      <!-- Moisture -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <i class="fas fa-tint moisture-icon"></i>
        </div>
        <div class="sensor-value">{{ moisture || 0 }}</div>
        <div class="sensor-unit">%</div>
        <div class="sensor-label">MOISTURE</div>
      </div>

      <!-- Nitrogen -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <div class="nitrogen-icon">N</div>
        </div>
        <div class="sensor-value">{{ nitrogen || 0 }}</div>
        <div class="sensor-unit">mg/kg</div>
        <div class="sensor-label">NITROGEN</div>
      </div>

      <!-- Phosphorus -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <div class="phosphorus-icon">P</div>
        </div>
        <div class="sensor-value">{{ phosphorus || 0 }}</div>
        <div class="sensor-unit">mg/kg</div>
        <div class="sensor-label">PHOSPHORUS</div>
      </div>

      <!-- Potassium -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <div class="potassium-icon">K</div>
        </div>
        <div class="sensor-value">{{ potassium || 0 }}</div>
        <div class="sensor-unit">mg/kg</div>
        <div class="sensor-label">POTASSIUM</div>
      </div>

      <!-- pH -->
      <div class="sensor-card">
        <div class="sensor-icon">
          <i class="fas fa-flask ph-icon"></i>
        </div>
        <div class="sensor-value">{{ ph || 0 }}</div>
        <div class="sensor-unit">pH</div>
        <div class="sensor-label">POTENTIAL OF HYDROGEN (PH)</div>
      </div>
    </div>

    <!-- ‚úÖ ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å -->
    <div class="map-container" *ngIf="showMainMap">
      <div #mapContainer class="map" style="width: 100%; height: 300px;"></div>
    </div>


    <!-- Popup ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î - Layout ‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Desktop -->
    <div class="popup-overlay" *ngIf="showPopup" (click)="closePopup()">
      <div class="popup-content" (click)="stopPropagation($event)">

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß -->
        <h3>üó∫Ô∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡∏î‡∏¥‡∏ô</h3>

        <!-- Main Content - Grid Layout ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Desktop -->
        <div class="popup-main-content">

          <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà - ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢ -->
          <div class="map-section">
            <div class="popup-description">
              <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á‡∏à‡∏∏‡∏î‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</p>
              <p>‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: <strong>{{ selectedPoints.length }}</strong> ‡∏à‡∏∏‡∏î</p>
              <p *ngIf="selectedPoints.length >= 3" class="polygon-info">
                ‚úÖ ‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡πâ‡∏ß ({{ selectedPoints.length }} ‡∏à‡∏∏‡∏î)
              </p>
              <p *ngIf="selectedPoints.length >= 3" class="area-size-info">
                üìè ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: <strong>{{ formatAreaToThaiUnits(calculateSimpleArea(selectedPoints)) }}</strong>
              </p>
              <p *ngIf="selectedPoints.length < 3" class="polygon-warning">
                ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏à‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î
              </p>
            </div>

            <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà -->
            <div class="map-popup"></div>
          </div>

          <!-- Sidebar - ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤ -->
          <div class="info-sidebar">

            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏¥‡∏Å‡∏±‡∏î -->
            <div class="coordinates-section">

              <!-- ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
              <div class="coordinates-card" *ngIf="selectedPoints.length > 0">
                <div class="card-header">
                  <span>üìç</span>
                  <span>‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ({{ selectedPoints.length }} ‡∏à‡∏∏‡∏î)</span>
                </div>
                <div class="coordinates-list">
                  <div *ngFor="let point of selectedPoints; let i = index" class="coordinate-item">
                    ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà {{ i + 1 }}: {{ point[0].toFixed(8) }}, {{ point[1].toFixed(8) }}
                  </div>
                </div>
              </div>

              <!-- ‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î -->
              <div class="coordinates-card" *ngIf="measurementPoints.length > 0">
                <div class="card-header">
                  <span>üéØ</span>
                  <span>‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏±‡∏î ({{ measurementPoints.length }} ‡∏à‡∏∏‡∏î)</span>
                </div>
                <div class="coordinates-list">
                  <div *ngFor="let point of measurementPoints; let i = index" class="coordinate-item measurement-point">
                    ‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà {{ i + 1 }}: {{ point[0].toFixed(8) }}, {{ point[1].toFixed(8) }}
                  </div>
                </div>
              </div>

            </div>

            <!-- ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô -->
            <div class="instructions">
              <div class="section-title">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
              <ul>
                <li>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏∏‡∏î</li>
                <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏à‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</li>
                <li>‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</li>
                <li>‡∏Å‡∏£‡∏≠‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™</li>
                <li>‡∏Å‡∏î "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏£‡πá‡∏à</li>
              </ul>
            </div>

          </div>

        </div>

        <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° -->
        <div class="popup-buttons">
          <button class="btn-secondary" (click)="clearMarks()" [disabled]="selectedPoints.length === 0">
            üóëÔ∏è ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏à‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          </button>
          <button class="btn-primary" (click)="confirmArea()" [disabled]="selectedPoints.length < 3">
            ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ({{ selectedPoints.length }} ‡∏à‡∏∏‡∏î) - {{ selectedPoints.length >= 3 ?
            formatAreaToThaiUnits(calculateSimpleArea(selectedPoints)) : '0 ‡πÑ‡∏£‡πà 0 ‡∏á‡∏≤‡∏ô 0 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£' }}
          </button>
          <button class="btn-cancel" (click)="closePopup()">
            ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>

      </div>
    </div>

  </div>
</div>