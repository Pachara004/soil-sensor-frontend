<div class="profile-container" (click)="closeCardMenu()">
  <!-- Back arrow ย้ายออกจาก card -->
  <i class="fas fa-arrow-left back" (click)="goBack()"></i>

  <!-- จุด 3 จุดย้ายออกจาก card -->
  <div class="card-menu" (click)="toggleCardMenu(); $event.stopPropagation()">
    <i class="fas fa-ellipsis-v"></i>
    <div class="menu-dropdown" *ngIf="showCardMenu" (click)="$event.stopPropagation()">
      <div class="menu-item" (click)="goToHistory(); closeCardMenu()">
        <i class="fas fa-history"></i>
        ดูประวัติการวัด
      </div>
      <div class="menu-item" (click)="goToContactAdmin(); closeCardMenu()">
        <i class="fas fa-user-shield"></i>
        ติดต่อ Admin
      </div>
    </div>
  </div>

  <div class="profile-card" (click)="$event.stopPropagation()">
    <h2 class="title">ข้อมูลผู้ใช้</h2>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>กำลังโหลดข้อมูล...</p>
    </div>

    <!-- Profile Data -->
    <div *ngIf="!isLoading" class="profile-data">

      <div class="info-row">
        <div class="label">Username</div>
        <input type="text" class="value" [value]="username || 'ไม่ระบุ'" readonly placeholder="ชื่อผู้ใช้" />
      </div>

      <div class="info-row">
        <div class="label">Email</div>
        <div class="email-container">
          <input type="email" class="value" [value]="email || 'ไม่ระบุ'" readonly placeholder="อีเมล" />
          <span *ngIf="emailVerified" class="verified-badge">✓ ยืนยันแล้ว</span>
          <span *ngIf="!emailVerified && email" class="unverified-badge">⚠ ยังไม่ยืนยัน</span>
        </div>
      </div>

      <div class="info-row">
        <div class="label">Phone</div>
        <input type="tel" class="value" [value]="phoneNumber || 'ไม่ระบุ'" readonly placeholder="เบอร์โทรศัพท์" />
      </div>

      <div class="info-row">
        <div class="label">User Type</div>
        <input type="text" class="value" [value]="userType || 'user'" readonly placeholder="ประเภทผู้ใช้" />
      </div>
    </div>

    <div class="button-group">
      <button class="edit-button" (click)="goToEditProfile()">แก้ไขข้อมูล</button>
      <button class="change-password-button" (click)="goToChangePassword()">เปลี่ยนรหัสผ่าน</button>
    </div>
  </div>
</div>