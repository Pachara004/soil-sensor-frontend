# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ History Detail

## üéØ **‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö:**
- **‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á** ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"
- **Leaflet library ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î** ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- **‡πÑ‡∏°‡πà‡∏°‡∏µ CSS ‡πÅ‡∏•‡∏∞ JavaScript** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Leaflet

## ‚úÖ **‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- **‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° Leaflet CSS ‡πÅ‡∏•‡∏∞ JavaScript** ‡πÉ‡∏ô index.html
- **‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πâ** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ library
- **‡πÑ‡∏°‡πà‡∏°‡∏µ fallback** ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Leaflet ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î

---

## üîß **‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥:**

### **1. ‡πÄ‡∏û‡∏¥‡πà‡∏° Leaflet CSS ‡πÅ‡∏•‡∏∞ JavaScript ‡πÉ‡∏ô index.html:**
```html
<!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° Leaflet JavaScript -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
```

### **2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô showMapInAreaDetails:**
```typescript
// ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ debug ‡πÅ‡∏•‡∏∞ error handling
showMapInAreaDetails() {
  if (!this.selectedArea || !this.selectedArea.measurements.length) {
    return;
  }
  
  setTimeout(() => {
    const mapContainer = document.querySelector('#mapContainer') as HTMLElement;
    if (!mapContainer) {
      console.log('‚ùå Map container not found');
      return;
    }
    
    // ‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
    mapContainer.innerHTML = '';
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Leaflet library ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    if (typeof (window as any).L === 'undefined') {
      console.log('‚ùå Leaflet library not loaded, showing simple map');
      this.showSimpleMap(mapContainer);
      return;
    }
    
    const L = (window as any).L;
    console.log('‚úÖ Leaflet library loaded, creating map');
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà...
  }, 200);
}
```

### **3. ‡πÉ‡∏ä‡πâ OpenStreetMap ‡πÅ‡∏ó‡∏ô MapTiler:**
```typescript
// ‚úÖ ‡πÉ‡∏ä‡πâ OpenStreetMap tiles (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API key)
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap contributors',
  maxZoom: 19
}).addTo(map);
```

### **4. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ Debug:**
```typescript
// ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° console logs ‡πÄ‡∏û‡∏∑‡πà‡∏≠ debug
console.log(`üìç Map center: ${centerLat}, ${centerLng}`);
console.log(`‚úÖ Added marker for point ${measurement.measurementPoint || index + 1} at ${measurement.lat}, ${measurement.lng}`);
console.log(`‚úÖ Map fitted to show ${markers.length} markers`);
console.log('‚úÖ Map created successfully');
```

---

## üöÄ **‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**

### **1. ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:**
```html
<!-- ‚úÖ ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ History Detail -->
<div class="area-summary">
  <h4>
    <i class="fas fa-map"></i>
    ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î
  </h4>
  <div id="mapContainer" style="height: 400px; width: 100%; border-radius: 12px; border: 2px solid #e0e0e0;">
    <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  </div>
  <p style="text-align: center; margin-top: 10px; color: #666;">
    <i class="fas fa-info-circle"></i>
    ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∏‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏à‡∏∏‡∏î
  </p>
</div>
```

### **2. Custom Markers ‡πÅ‡∏ö‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°:**
```typescript
// ‚úÖ Custom markers ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î
const customIcon = L.divIcon({
  className: 'custom-marker',
  html: `
    <div style="
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border: 3px solid white;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    ">
      ${measurement.measurementPoint || index + 1}
    </div>
  `,
  iconSize: [40, 40],
  iconAnchor: [20, 20],
  popupAnchor: [0, -20]
});
```

### **3. Popup ‡πÅ‡∏ö‡∏ö‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°:**
```html
<!-- ‚úÖ Popup ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏à‡∏∏‡∏î -->
<div style="min-width: 250px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
  <div style="background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 10px; margin: -10px -10px 10px -10px; border-radius: 8px 8px 0 0;">
    <h4 style="margin: 0; font-size: 16px;">üìç ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà ${measurement.measurementPoint || index + 1}</h4>
  </div>
  <div style="padding: 5px 0;">
    <p style="margin: 5px 0;"><strong>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${new Date(measurement.date || measurement['createdAt']).toLocaleDateString('th-TH')}</p>
    <p style="margin: 5px 0;"><strong>üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥:</strong> <span style="color: #e74c3c; font-weight: bold;">${this.formatNumber(measurement.temperature || 0)}¬∞C</span></p>
    <p style="margin: 5px 0;"><strong>üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô:</strong> <span style="color: #3498db; font-weight: bold;">${this.formatNumber(measurement.moisture || 0)}%</span></p>
    <p style="margin: 5px 0;"><strong>üß™ pH:</strong> <span style="color: #9b59b6; font-weight: bold;">${this.formatNumber(measurement.ph || 0, 1)}</span></p>
    <p style="margin: 5px 0;"><strong>üå± ‡πÑ‡∏ô‡πÇ‡∏ï‡∏£‡πÄ‡∏à‡∏ô:</strong> <span style="color: #27ae60; font-weight: bold;">${this.formatNumber(measurement.nitrogen || 0)} mg/kg</span></p>
    <p style="margin: 5px 0;"><strong>üî¨ ‡∏ü‡∏≠‡∏™‡∏ü‡∏≠‡∏£‡∏±‡∏™:</strong> <span style="color: #f39c12; font-weight: bold;">${this.formatNumber(measurement.phosphorus || 0)} mg/kg</span></p>
    <p style="margin: 5px 0;"><strong>‚ö° ‡πÇ‡∏û‡πÅ‡∏ó‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°:</strong> <span style="color: #e67e22; font-weight: bold;">${this.formatNumber(measurement.potassium || 0)} mg/kg</span></p>
  </div>
</div>
```

---

## üß™ **‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:**

### **1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Build:**
```bash
ng build --configuration=development
# ‚úÖ Build ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ error
```

### **2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤ "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î":**
- **‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ History** ‚Üí ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"
- **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console** ‚Üí ‡∏î‡∏π debug logs
- **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà** ‚Üí ‡πÅ‡∏™‡∏î‡∏á custom markers ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç
- **‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà markers** ‚Üí ‡πÅ‡∏™‡∏î‡∏á popup ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏î

### **3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console Logs:**
```javascript
// ‚úÖ Console logs ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á
‚úÖ Leaflet library loaded, creating map
üìç Map center: 16.246, 103.250
‚úÖ Added marker for point 1 at 16.246, 103.250
‚úÖ Added marker for point 2 at 16.247, 103.251
‚úÖ Map fitted to show 2 markers
‚úÖ Map created successfully
```

---

## üéØ **‡∏™‡∏£‡∏∏‡∏õ:**

**‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ History Detail ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!** üå±‚ú®

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. **‡πÄ‡∏û‡∏¥‡πà‡∏° Leaflet CSS ‡πÅ‡∏•‡∏∞ JavaScript** ‡πÉ‡∏ô index.html
2. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô showMapInAreaDetails** ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
3. **‡πÉ‡∏ä‡πâ OpenStreetMap** ‡πÅ‡∏ó‡∏ô MapTiler (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ API key)
4. **‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ debug** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏±‡∏ç‡∏´‡∏≤
5. **‡πÄ‡∏û‡∏¥‡πà‡∏° error handling** ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Leaflet ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**
- **‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"
- **Custom markers ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î
- **Popup ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô** ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏à‡∏∏‡∏î‡∏ß‡∏±‡∏î
- **‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥** ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

**üéØ ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏ô‡πâ‡∏≤ "‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß!** üöÄ‚ú®

**‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!** üéâ
